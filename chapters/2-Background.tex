\chapter{Background}
This chapter gives an overview of the necessary background information required for this research. Air quality monitors are explained in general with its use, capabilities and sensors. Passive network eavesdropping and private information inference are introduced as these will be the vulnerability exploited in this research. Lastly, an overview of the communication protocol IEEE 802.11, \gls{Wi-Fi}, is presented as this is where the passive network eavesdropping attack will be launched. 

\section{Air Quality Monitors}
Air quality monitors are used as sensors to collect sensor data from different sources in the air \cite{GeneralAirQualityMonitor}. The \gls{IoT} devices can store data in different ways. Cloud storing is the most preferred storage solution for \gls{IoT} devices, but also local servers, internal storage and memory cards can be used to store data from air quality monitors \cite{AQMBigSource}. Displaying data to users of air quality monitors is important to give the user either information about the indoor air quality, or recommendations on how to improve the air quality \cite{AQMBigSource}. The most developed and recent method of doing so, is through an application on the users phone, but also solutions where users can login to a website exists. Many air quality monitors also have a screen on the device that shows certain values from the sensors \cite{AQMBigSource}.

As indoor air quality monitors can be equipped with different features, a brief explanation of some of the sensors on an air quality monitor is necessary to understand why and how private information can be gathered from these sensors:
\begin{itemize}
    \item \textbf{Carbon Dioxide (\(CO_2\))} is a chemical formula that is mainly made from human or animal combustion \cite{CO2}. This implicates that the more humans or animals that are in the same indoor environment, the higher occurrence of \(CO_2\) will be collected by sensors and transmitted to the air quality monitors. However, plants, sunlight and ventilation can bind \(CO_2\) and reduce the amount of \(CO_2\) particles in an indoor environment.
    \item \textbf{Noise} is an interesting feature of air quality monitors as it is considered a health problem \cite{Noise}. Exposure to loud noises at a small amount of time or long-term noise can harm peoples health and result in hearing difficulties. As we use a lot of time in our home, this sensor is applicable here. 
    \item \textbf{\gls{VOC}} is a collective term for any combination of carbon, with the exception of some compounds \cite{VOC}. These harmful compounds can be found in gases from building materials, cigarettes, cleaning articles, painting or cooking to mention some. \gls{TVOC} is a term for defining the total amount of \gls{VOC}s. The amount of \gls{VOC} in an indoor environment can be reduced by ensuring fresh air or using kitchen fans \cite{RecommendedIAQ}. HCHO, also known as formaldehyde, is classified as a \gls{VOC} \cite{HCHO}.
    \item \textbf{Humidity} is calculated from the ratio between water vapor in the air compared to the maximum amount of water vapor possible in the air \cite{RecommendedIAQ}. Even though humans can endure high variations in humidity, low humidity can result in health problems such as irritated eyes, dry skin or dry mocus membranes. High humidity can begin mold processes that can damage indoor furniture or walls and lead to health problems like asthma or allergy. User behaviour that can affect the humidity includes taking a shower, drying clothes or cooking. 
    \item \textbf{Temperature} is a measure unit for how hot or cold an environment is and is measured using a thermometer. It is the most commonly used unit for how comfortable humans feel. A too high temperature can result in lack of energy and sleepiness and too low temperature can result in reduced muscle function or heighten symptoms of rheumatism \cite{Temp}.
\end{itemize}

Several factors play a key part when selecting which air quality monitor is most suitable for the users needs. Considering the different functionality an air quality monitor can have, it is also important to look into transmission range, power consumption and maintenance \cite{AQMBigSource}. However, the main goal of an air quality monitor is to monitor the air and therefore the sensors on the devices should be a top priority when selecting a device. Air quality monitors can specialize in one measuring unit in the air or have the functionality to measure several air quality factors. They will be incorporated in users homes and therefore the appearance will also be a factor when choosing the right device \cite{IAQMonitorCommunicationReview}. 

There are several companies that manufacture and sell air quality monitors. Some companies sell air quality monitors whose main goal is to monitor the indoor air quality, such as Airthings \cite{Airthings}, Netatmo \cite{Netatmo} and Mill \cite{Mill}. Other companies integrates the air quality monitor with other devices that have a main goal of changing humidity or \(CO_2\) levels in the indoor environment based on the sensor values to better the indoor air conditions. Examples of these are Phillips \cite{Philips} and Dyson \cite{Dyson}. These companies have different air quality monitors that users can choose from based on their needs. 

\section{Private Information Inference}
Considering the amount of information an air quality monitor can collect about an individual or a smart home, privacy leakage is a vulnerability \cite{SecPrivSmartCity}. Privacy is referred to as every person's right to have control over their own data, hereby knowing how their data is used or distributed to other parties \cite{IoTSecPrivSafeEth}. When malicious attackers try to gather sensitive information about an individual user or group of users, it is so called a privacy attack \cite{CyberEntitySecInIoT}. The attacker aims to target the confidentiality of the user, while gathering information such as location, preferences, personal behaviour or similar private information. A challenge with an \gls{IoT} system compared to other computer systems is that many of the \gls{IoT} devices are always on, connected in a user's home and sense user behaviour in a passive and non-intrusive way. This makes it even more difficult to understand the scope of all the private information gathered by an \gls{IoT} system \cite{IoTSecPrivSafeEth}.

\gls{IoT} systems in smart homes are often made up by different brands and communication protocols and does not follow one standard like \gls{IoT} systems in an industrial environment can do \cite{IoTPrivSecSmarthome}. There is no central management of security patching or having a strong baseline of security that protects the private data stored on a sensor. A big threat to \gls{IoT} privacy is identification and profiling, where an attacker can link a user to their behaviour in the environment \cite{IoTSecPrivSafeEth}. An adversary can then study the data from a user's environment and identify what that user is doing. An example can be that by reading an increase in data from an \gls{IoT} device communicating to a server for \gls{IoT} coffee appliances, an attacker can know that the user is making coffee at a specific time of day. By collecting this data over a longer period of time, the attacker will know the routines of a user. Even though a morning coffee can be something a user posts openly on social medias, not having control of the data and who can access and process it is a violation of privacy. This could also be launched against several \gls{IoT} devices in an environment at once and knowing user specific routines. 

A challenge when it comes to privacy for \gls{IoT} systems is weighting functionality against privacy and security \cite{PrivacyIoTSurvey}. There are security measures that can be implemented for the devices to mitigate private information inference, such as authentication and authorization, data anonymization, and cryptology. However, not only attackers wanting to know about user's private information poses a threat to users' \gls{IoT} data, but also interested parties wanting to know user behaviour to make more suitable solutions and targeted advertisement to make more money. Hence, users need to be aware of where their data is shared to ensure that private information is not shared without them knowing. On the other side, users are requesting better functionality for the \gls{IoT} devices, wanting them to behave more customized and optimized to their needs which requires more data to be shared. Although security vs privacy is a known issue in the computer world, \gls{IoT} devices are resource restrained and preferably as ascetically integrated in user's home as possible. Therefore, it is a challenge applying security measures to ensure privacy for these devices \cite{PrivacyIoTSurvey}. 

\section{Passive Network Eavesdropping}
Eavesdropping network communication can either be passive or active. When an attacker conducts an active eavesdropping attack on a target, the data in the communication link is both inferred and modified \cite{Eavesdropping}. However, in a passive network eavesdropping attack, the eavesdropper does not modify any data on the link, but simply gathers data transmitted without changing the communication. The overall goal of eavesdropping is often to access private information that is sent on the communication channel. This can be anything from credentials to secret messages, or as in this research, private information about users and their habits \cite{Eavesdropping}. Since the communication is not affected by a passive network eavesdropping attack, the attacker does not need to be as careful in disguising itself as in an active eavesdropping attack.  

There are security measures to reduce the chance of being eavesdropped, both actively and passively. Since eavesdroppers aim to listen to the communication, encrypting the traffic is an effective way to make it harder to conduct an eavesdropping attack. Also, coverting channels to hide the identity of the communicating parties can be used to prevent the eavesdroppers from finding the right communication channel to eavesdrop \cite{Eavesdropping}.

To perform a passive network eavesdropping attack on wireless communication channels, it is not necessary to join the targeted network, but the attacker needs to be within the signal range of the network \cite{WifiEavesdropEnc}. In order to carry out a passive network eavesdropping attack, the right hardware and software must be configured \cite{Sniffingtech}. A wireless network sniffer can collect wireless traffic for the corresponding communication protocol within its signal range. This device needs to be configured to capture packets that are not meant for the device it is connected to, normally a computer or server, but every packet within its signal strength. This is often called promiscuous or monitoring mode. 

It exists a number of network sniffers for every wireless communication protocol, such as \gls{Wi-Fi}, Bluetooth, ZigBee or Z-wave \cite{Sniffingtech}. Some computers even have a built-in wireless network card that can be used to monitor traffic, not directed to the computers address. Once the sniffer is configured to capture packets, a monitoring tool is necessary to collect, store and analyze the packets. Different software monitoring tools can be used for this purpose, and it is often recommended to use specific ones based on the operating system of the system that carries out the attack. A common choice for both Linux and Windows is Wireshark \cite{Wireshark}, which is a free monitoring tool. With both the hardware sniffer and software monitoring tool configured correctly, a network eavesdropping attack can be carried out. 

\section{Communication Protocols}
Air quality monitors send their sensor data on the network to store and analyze it and communicates with a hub or a users phone to display the sensor values. As they exist with different functionality and specifications, their communication protocols differs, like other groups of \gls{IoT} devices \cite{AQMBigSource}. \gls{Wi-Fi} is the most preferred protocol with Bluetooth and ZigBee following \cite{saini2020indoor}. As this thesis is limited to air quality monitor devices using \gls{Wi-Fi} to communicate, the next subsection will elaborate on this protocol.

\subsection{IEEE 802.11 - Wi-Fi}
\gls{Wi-Fi} \cite{WiFiAlliance} is one of the most used technologies for communicating and it is defined, developed and standardized by WiFi Alliance \cite{WiFiAlliance}. \gls{Wi-Fi} is based on the standard IEEE 802.11 Wireless LAN set by IEEE Standard for Information Technology \cite{WifiStandard}. The transmission range for \gls{Wi-Fi} is up to 100 meters and it uses 5-60GHz in the frequency band \cite{IAQMonitorCommunicationReview}.
\\\\
\begin{figure} [H]
    \centering
    \includegraphics[width=0.75\textwidth]{figures/WiFiStandard.png}
    \caption{A Wi-Fi network \cite{Datacom}}
    \label{fig:WiFiStandard}
\end{figure}
Figure \ref{fig:WiFiStandard} illustrates how a \gls{Wi-Fi} network works. In a \gls{Wi-Fi} local area network each communicating node, such as computers, \gls{IoT} devices or mobile phones, connects to an \gls{AP}, which connects the devices to the Internet \cite{Datacom}. The \gls{AP} works as a base station for the devices and provides the basic components that makes up the fundamental for \gls{Wi-Fi}, called \gls{BSS}. The \gls{AP} connects to the Internet commonly using a switch or router, which can be integrated in the same physical device. When connecting to a \gls{Wi-Fi} network, a \gls{SSID}, often set as a default name by the \gls{ISP} or a customized name made by the network administrator, is visible for devices trying to connect to the network. The \gls{SSID} is used to distinguish multiple \gls{AP}s to choose the right one to connect to. Each \gls{AP} will periodically send out broadcast messages in a beacon frame containing its \gls{MAC} address and \gls{SSID}. When the device has chosen the right \gls{AP} to connect to based on the beacon frame, an association begins between the \gls{AP} and the device to create a wireless link. This link will be used by the \gls{AP} to send packets from the Internet directed to the device and from the device to Internet \cite{Datacom}. 

A network packet sent from a device communicating in a \gls{Wi-Fi} network is called a data frame \cite{Datacom}. The data frame is illustrated in Figure \ref{fig:WiFiDataframe}. The frame control field contains several different fields for encryption, acknowledgment and association to mention some \cite{Datacom}. The duration field holds the value of how long to reserve a channel to transmit the data frame and acknowledgement. Sequence numbers are used by a receiver to be able to make up the order the packets are sent if they arrive in the wrong order over the medium. As shown in Figure \ref{fig:WiFiDataframe}, there are 4 different \gls{MAC} address fields with values such as source and destination \gls{MAC} addresses \cite{WifiStandard}. The \gls{CRC} field is controlled by the receiver to check for bit errors. The final field is the payload where the transmitted data relies in an \gls{IP} or \gls{ARP} packet \cite{Datacom}. 

\begin{figure} [!h]
    \includegraphics[width=1\textwidth]{figures/WifiDataFrame.png}
    \caption{\gls{Wi-Fi} data frame \cite{Datacom}}
    \centering
    \label{fig:WiFiDataframe}
\end{figure}

An attacker sniffing network traffic on a \gls{Wi-Fi} network will observe different packets. \gls{Wi-Fi} uses three different categories of frames: management, control and data frames \cite{WiFiFrameMGMT}. Management frames are used to manage \gls{Wi-Fi} traffic. When connecting to a network, association and authentication packets are sent, and when disconnecting, disassociation and de-authentication packets are transmitted. Beacon and probe frames are also sent to find the right network and manage the connection. The control frames are used to assist both management and data traffic \cite{WiFiFrames}. The frames do not contain any body, but rather header information that can be used to ensure management and data frames. The last group of frames sent on a \gls{Wi-Fi} network is data frames. The data frames is where the actual data that the the parties wants to transmit to each other relies. 

Security mechanism on \gls{Wi-Fi} called \gls{WPA}-2 and \gls{WPA}-3 are commonly used and have stronger encryption and integrity where defense against attacks are implemented. This thesis will not investigate any further on security mechanisms of \gls{Wi-Fi}, but more information about security on \gls{Wi-Fi} can be found in \cite{WAP}. 